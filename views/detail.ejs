<!DOCTYPE html>
<html lang="en">
<%- include('partials/head') %>
<body>
    <%- include('partials/navbar') %>

    <div class="details-container" style="padding-top: 100px;">
        <div class="details-link">
            <p><a href="/" style="text-decoration: none; color: inherit;">Home</a> > <a href="/catalog" style="text-decoration: none;">Catalog</a> > <%=item.name%></p>
        </div>
        
        <div class="details-content">
            <div class="details-picture">
                <div class="main-picture">  
                    <img id="mainImage" src="/image/product/<%=item.picture[0]%>">
                </div>

                 <div class="thumbnail-list">
                    <% item.picture.forEach((img) => { %>
                        <img src="/image/product/<%= img %>" onclick="changeImage(this)" />
                    <% }) %>
                    </div>
                
                <div class="mobile-indicator">
                    <% item.picture.forEach((img, index) => { %>
                        <div class="dot <%= index === 0 ? 'active' : '' %>" onclick="showImageByIndex(<%=index%>)"></div>
                    <% }); %>
                </div>
            </div>
            <div class="details-description">
                <div class="description-name">
                    <p style="font-size: 24px;"><%=item.name%> </p>
                </div>
                <div class="description-price">
                    <p style="font-size: 20px;">Rp<%=item.formattedPrice%></p>
                </div>
                <div class="description-size">
                    <div class=""><p style="font-size: 15px;">Size</p></div>
                    <div class="size-details">
                        <ul >
                            <% for (let i = 0; i < item.size.length; i++) { %>
                                        <li><%=item.size[i]%></li>
                                   <% } %>
                            
                        </ul>
                    </div>
                </div>
                <div class="description-cta">
                    <div class="description-cta-text">
                        <p>BUY NOW</p>
                    </div>
                </div>
                <div class="description-details">
                    <div class="" style="text-align: center; font-size: 20px;">Product Details</div>
                    <div class="details-text">
                        <ul>
                            <% for (let i=0; i < item.details.length;i++){%>
                                <li><%=item.details[i]%></li>
                       <%     }%>
                            
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <div class="related-product">
            <p style="text-align: center; font-size: 25px;">You may also like</p>
            <div class="product-preview">

                <% related.forEach(item=>{%>
                <div class="preview-box"
                data-aos="fade-up"
                data-aos-easing="linear"
                 data-aos-duration="1000" 
                 onclick="window.location.href='/product/<%=item.slug%>';">
                                    <div class="product-image">
                                                <img class="default-image" src="/image/product/<%=item.picture[0]%>" alt="Product">
                                                <img class="hover-img" src="/image/product/<%=item.picture[1]%>" alt="Product Hover">
                                            </div>
                                            <div class="product-details">
                                                <p><%=item.name%></p>
                                                <p>Rp<%=item.formattedPrice%></p>
                                            </div>
                                </div>
               <% })%>
                
                
                
                
                            
                        </div>
            </div>
        </div>
        
    </div>

 <%- include('partials/footer') %>



<script>
  const pictures = <%-JSON.stringify(item.picture)%>;
  let currentIndex = 0;
  const mainImage = document.getElementById("mainImage");
  const dots = document.querySelectorAll(".mobile-indicator .dot");

  function updateImage(index) {
    currentIndex = index;
    mainImage.src = `/image/product/${pictures[index]}`;
    dots.forEach((dot, i) => {
      dot.classList.toggle("active", i === index);
    });
  }

  function changeImage(thumb) {
    const thumbs = document.querySelectorAll(".thumbnail-list img");
    thumbs.forEach((img, index) => {
      if (img.src === thumb.src) {
        updateImage(index);
      }
    });
  }

  function showImageByIndex(index) {
    updateImage(index);
  }

  let startX = 0;
  mainImage.addEventListener("touchstart", (e) => {
    startX = e.touches[0].clientX;
  });

  mainImage.addEventListener("touchend", (e) => {
    const endX = e.changedTouches[0].clientX;
    if (endX < startX - 30 && currentIndex < pictures.length - 1) {
      updateImage(currentIndex + 1);
    } else if (endX > startX + 30 && currentIndex > 0) {
      updateImage(currentIndex - 1);
    }
  });
</script>


   <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js" integrity="sha384-ndDqU0Gzau9qJ1lfW4pNLlhNTkCfHzAVBReH9diLvGRem5+R9g2FzA8ZGN954O5Q" crossorigin="anonymous"></script>
   <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
   <script>
    AOS.init({
    once: true 
  });
</script>
</body>
</html>